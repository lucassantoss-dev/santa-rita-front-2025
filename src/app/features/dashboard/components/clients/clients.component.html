<!-- <div *ngIf="!loading" style="display: flex; align-items: center; justify-content: center; width: 100%; height: 90%;"> -->
  <!-- <app-loading></app-loading> -->
<!-- </div> -->

<div class="table-container">
  <h2 class="mt-2">Lista de Clientes</h2>
  <mat-card>
    <mat-card-content>
      <div class="header mb-3" style="display: flex; justify-content: flex-end;">
        <button mat-raised-button class="search-button" (click)="onCreate()">
          <mat-icon>add</mat-icon> Novo
        </button>
      </div>
      <mat-divider></mat-divider>
      <div class="row filter mb-2 mt-4 align-items-end">
        <span style="font-size: 11px; font-weight: bold; color: #c3c3c3;">FILTROS</span>
        <div class="col-md-6">
          <div class="mb-2">
            <input type="text" [(ngModel)]="nameFilter" id="UserName" class="form-control" placeholder="Nome" style="max-width: 100%; font-size: 0.95rem; padding: 0.3rem 0.5rem;">
          </div>
        </div>
        <div class="col-md-3">
          <div class="mb-2 d-flex flex-row gap-2 justify-content-end" style="gap: 4px; min-width: 160px;">
            <button mat-raised-button class="search-button d-flex align-items-center" (click)="onSearch()" style="min-width: 70px; font-size: 0.95rem; padding: 0.3rem 0.5rem;">
              <mat-icon style="margin-right: 3px; font-size: 18px;">search</mat-icon>
              Pesquisar
            </button>
            <button mat-stroked-button class="d-flex align-items-center" (click)="clearFilters()" style="min-width: 60px; font-size: 0.95rem; padding: 0.3rem 0.5rem;">
              <mat-icon style="margin-right: 3px; font-size: 18px;">clear</mat-icon>
              Limpar
            </button>
          </div>
        </div>
      </div>
      <table mat-table [dataSource]="pagedData" class="mat-elevation-z8"
        *ngIf="dataSource && pagedData.length > 0">
        <!-- Coluna de Nome -->
        <ng-container matColumnDef="block">
          <th mat-header-cell *matHeaderCellDef> Quadra </th>
          <td mat-cell *matCellDef="let element"> {{ element.block }} </td>
        </ng-container>

        <!-- Coluna de Descrição -->
        <ng-container matColumnDef="number">
          <th mat-header-cell *matHeaderCellDef> Número </th>
          <td mat-cell *matCellDef="let element"> {{ element.number }} </td>
        </ng-container>
        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef> Tipo </th>
          <td mat-cell *matCellDef="let element"> {{ element.type }} </td>
        </ng-container>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef> Nome </th>
          <td mat-cell *matCellDef="let element"> {{ element.name }} </td>
        </ng-container>

        <ng-container matColumnDef="address">
          <th mat-header-cell *matHeaderCellDef> Endereço </th>
          <td mat-cell *matCellDef="let element"> {{ element.address }} </td>
        </ng-container>

        <!-- Coluna de Ações -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Ações </th>
          <td mat-cell *matCellDef="let element">
            <button mat-icon-button class="custom-button" (click)="onEdit(element._id)" matTooltip="Edição de Cliente">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="onDelete(element._id)" matTooltip="Deleção de Cliente">
              <mat-icon>delete</mat-icon>
            </button>
            <button mat-icon-button color="primary" (click)="downloadCard(element._id)" matTooltip="Gerar Carteira">
              <mat-icon>badge</mat-icon>
            </button>
            <button mat-icon-button color="secondary" (click)="downloadCertificate(element._id)" matTooltip="Certificado">
              <mat-icon>contact_mail</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      <div *ngIf="dataSource && dataSource.filteredData && dataSource.filteredData.length > 0" style="margin-top: 16px;">
        <mat-paginator
          [length]="dataSource.filteredData.length"
          [pageSize]="pageSize"
          [pageIndex]="pageIndex"
          [pageSizeOptions]="pageSizeOptions"
          (page)="onPageChange($event)">
        </mat-paginator>
      </div>
      <div
        *ngIf="pagedData?.length === 0"
        class="alert alert-info mt-3"
        style="text-align: center"
      >
        Nenhum item encontrado.
      </div>
    </mat-card-content>
  </mat-card>
</div>
